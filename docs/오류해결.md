# ë””ì§€í„¸í™”í™˜ í”„ë¡œì íŠ¸ - ì˜¤ë¥˜ í•´ê²° ê¸°ë¡ (í˜„ì¬ ì§„í–‰ ì¤‘)

> ì´ ë¬¸ì„œëŠ” **í˜„ì¬ ì§„í–‰ ì¤‘ì¸** ì˜¤ë¥˜ë§Œ í‘œì‹œí•©ë‹ˆë‹¤.
> í•´ê²°ëœ ì˜¤ë¥˜ëŠ” ìë™ìœ¼ë¡œ [archive/ì˜¤ë¥˜í•´ê²°-2026-01-archived.md](./archive/ì˜¤ë¥˜í•´ê²°-2026-01-archived.md)ë¡œ ì´ë™ë©ë‹ˆë‹¤.

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-02-02

---

## ğŸ“‹ í˜„ì¬ ìƒíƒœ

**âš ï¸ ì§„í–‰ ì¤‘ì¸ ì˜¤ë¥˜: 1ê±´**

- **ì˜¤ë¥˜ #22**: í…œí”Œë¦¿ ì˜ìƒ ì €ì¥ ì‹œ ë©”íƒ€ë°ì´í„° ëˆ„ë½ â†’ âš ï¸ ë””ë²„ê¹… ì¤‘ (2026-02-02)

ë§ˆì§€ë§‰ í•´ê²°ëœ ì˜¤ë¥˜:
- **ì˜¤ë¥˜ #21**: ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ â†’ âœ… í•´ê²° ì™„ë£Œ (2026-01-23)
- **ì˜¤ë¥˜ #20**: Vercel FFmpeg ë¯¸ì‘ë™ â†’ âœ… í•´ê²° ì™„ë£Œ (2026-01-23)
- **ì˜¤ë¥˜ #19**: 413 Payload Too Large â†’ âœ… í•´ê²° ì™„ë£Œ (2026-01-23)
- **ì˜¤ë¥˜ #18**: Firebase Storage CORS ì—ëŸ¬ â†’ âœ… í•´ê²° ì™„ë£Œ (2026-01-23)

---

## í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì˜¤ë¥˜ (2026-02-02)

### ì˜¤ë¥˜ #22: í…œí”Œë¦¿ ì˜ìƒ ì €ì¥ ì‹œ ë©”íƒ€ë°ì´í„° ëˆ„ë½ âš ï¸

**ë°œìƒì¼**: 2026-02-02
**íŒŒì¼**: `HologramWizard.tsx`, `ResultStep.tsx`, `.env.local`
**ìƒíƒœ**: âš ï¸ ë””ë²„ê¹… ì¤‘

#### ë¬¸ì œ ìƒí™©

- í…œí”Œë¦¿ ëª¨ë“œ(Single/Composition)ì—ì„œ ì˜ìƒ ìƒì„± í›„ ì €ì¥ ê¸°ëŠ¥ì´ **ì‘ë™ì€ í•˜ì§€ë§Œ ì˜ëª»ëœ ë°ì´í„°ë¡œ ì €ì¥**ë¨
- API ì‘ë‹µ: `POST /api/videos 200 in 294ms` (ì„±ê³µ)
- ì‹¤ì œ ì €ì¥: Firestoreì— `category='general'`, `style='default'`, `sceneData=null`ë¡œ ì €ì¥ (ì¶”ì •)
- ì‚¬ìš©ìê°€ ì„ íƒí•œ wedding-fancy ë“±ì˜ í…œí”Œë¦¿ ì •ë³´ê°€ ëˆ„ë½ë¨

#### ì›ì¸

**ê·¼ë³¸ ì›ì¸**: HologramWizardì—ì„œ ResultStepìœ¼ë¡œ í•„ìˆ˜ props (category, style, scenes)ë¥¼ ì „ë‹¬í•˜ì§€ ì•ŠìŒ

1. **Props ëˆ„ë½**: ResultStep ì»´í¬ë„ŒíŠ¸ì— category, style, scenesê°€ ì „ë‹¬ë˜ì§€ ì•ŠìŒ
2. **Fallback ê°’ ì‚¬ìš©**: API ìš”ì²­ ì‹œ `category || 'general'`, `style || 'default'` ì‚¬ìš©
3. **Firebase Credentials ì˜¤ë¥˜**: `.env.local`ì˜ FIREBASE_SERVICE_ACCOUNT_KEYì— ë¶ˆí•„ìš”í•œ ì™¸ë¶€ ë”°ì˜´í‘œ ì¡´ì¬

#### í•´ê²° ë°©ë²•

**1ë‹¨ê³„: Props ì „ë‹¬ ìˆ˜ì • âœ…**

`HologramWizard.tsx` ìˆ˜ì •:
```tsx
// Single ëª¨ë“œ (156-164í–‰)
case 3:
  return (
    <ResultStep
      videoUrl={finalVideoUrl}
      onReset={handleReset}
      scenes={sceneData?.scenes}           // âœ… ì¶”ê°€
      category={sceneData?.category}       // âœ… ì¶”ê°€
      style={sceneData?.style}             // âœ… ì¶”ê°€
    />
  );

// Composition ëª¨ë“œ (193-203í–‰)
case 3:
  return (
    <ResultStep
      videoUrl={finalVideoUrl}
      onReset={handleReset}
      scenes={compositionMessages?.map(...) || undefined}
      isCompositionMode={true}
      category={compositionData?.category}     // âœ… ì¶”ê°€
      style={compositionData?.style}           // âœ… ì¶”ê°€
      eventInfo={compositionData?.eventInfo}   // âœ… ì¶”ê°€
    />
  );
```

**2ë‹¨ê³„: ResultStep interface í™•ì¥ âœ…**

`ResultStep.tsx` ìˆ˜ì • (12-30í–‰):
```tsx
interface EventInfo {
  groomName?: string;
  brideName?: string;
  weddingDate?: string;
  businessName?: string;
  openingDate?: string;
  eventName?: string;
  organizer?: string;
}

interface ResultStepProps {
  videoUrl: string;
  onReset: () => void;
  scenes?: SceneData[];
  isCompositionMode?: boolean;
  category?: string;      // âœ… ì¶”ê°€
  style?: string;         // âœ… ì¶”ê°€
  eventInfo?: EventInfo;  // âœ… ì¶”ê°€
}
```

**3ë‹¨ê³„: useEffect ì•ˆì •í™” âœ…**

`ResultStep.tsx` ìˆ˜ì • (97-150í–‰):
- useEffect ë‚´ë¶€ì— save í•¨ìˆ˜ êµ¬í˜„
- ì˜ì¡´ì„± ë°°ì—´ì— category, style, scenes, eventInfo ì¶”ê°€
- cleanup í•¨ìˆ˜ë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€

**4ë‹¨ê³„: Firebase Credentials ìˆ˜ì • âœ…**

`.env.local` 17í–‰ ìˆ˜ì •:
```bash
# Before (ì˜¤ë¥˜ ë°œìƒ)
FIREBASE_SERVICE_ACCOUNT_KEY="{\"type\":\"service_account\",...}"

# After (ìˆ˜ì •ë¨)
FIREBASE_SERVICE_ACCOUNT_KEY={"type":"service_account",...}
```

**íš¨ê³¼**: ì™¸ë¶€ ë”°ì˜´í‘œ ì œê±°ë¡œ JSON.parse()ê°€ ì˜¬ë°”ë¥¸ ê°ì²´ ë°˜í™˜

#### í˜„ì¬ ì§„í–‰ ìƒí™©

**ì™„ë£Œëœ ì‘ì—… âœ…**:
1. Props ì „ë‹¬ ë¡œì§ ì¶”ê°€
2. Firebase credentials ì˜¤ë¥˜ ìˆ˜ì •
3. API 200 OK ì‘ë‹µ í™•ì¸
4. ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€ (ResultStep mounted)

**ëŒ€ê¸° ì¤‘ì¸ ì‘ì—… âš ï¸**:
1. ë¸Œë¼ìš°ì € ì½˜ì†” ë¡œê·¸ í™•ì¸ (category, style ì‹¤ì œ ê°’)
2. Firestore ë°ì´í„°ë² ì´ìŠ¤ ì§ì ‘ í™•ì¸
3. ë§ˆì´í˜ì´ì§€ì—ì„œ ì˜ìƒ í‘œì‹œ ì—¬ë¶€ í™•ì¸

#### ì˜ˆìƒ ê²°ê³¼

**ìˆ˜ì • ì „**:
```json
{
  "category": "general",      // âŒ ì˜ëª»ëœ ê°’
  "style": "default",         // âŒ ì˜ëª»ëœ ê°’
  "sceneData": null           // âŒ ëˆ„ë½
}
```

**ìˆ˜ì • í›„**:
```json
{
  "category": "wedding",      // âœ… ì˜¬ë°”ë¥¸ ê°’
  "style": "fancy",           // âœ… ì˜¬ë°”ë¥¸ ê°’
  "sceneData": {              // âœ… ë³µì›ë¨
    "scenes": [...]
  }
}
```

#### ë””ë²„ê¹… ë¡œê·¸

**ë¸Œë¼ìš°ì € ì½˜ì†” í™•ì¸ í•„ìš”**:
```javascript
// ResultStep.tsx:50-59
ResultStep mounted: {
  videoUrl: "https://storage.googleapis.com/...",
  isCompositionMode: false,
  category: ???,        // 'wedding' ì˜ˆìƒ, undefinedì¼ ê°€ëŠ¥ì„±
  style: ???,           // 'fancy' ì˜ˆìƒ, undefinedì¼ ê°€ëŠ¥ì„±
  scenesCount: ???,     // 6 ì˜ˆìƒ
  hasUser: true,
  savedVideoId: null,
  isSaving: false
}
```

#### ê´€ë ¨ ì˜¤ë¥˜

- **ì˜¤ë¥˜ #21**: ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ (2026-01-23 í•´ê²°)
- **ì˜¤ë¥˜ #20**: Vercel FFmpeg ë¯¸ì‘ë™ (2026-01-23 í•´ê²°)

---

## ìµœê·¼ í•´ê²°ëœ ì˜¤ë¥˜ (2026-01-23)

### ì˜¤ë¥˜ #21: ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ âœ…

**ë°œìƒì¼**: 2026-01-23
**ì™„ë£Œì¼**: 2026-01-23
**íŒŒì¼**: `.env.local`
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ

#### ë¬¸ì œ ìƒí™©

- ë¡œì»¬ì—ì„œ AI ì˜ìƒ ìƒì„± í…ŒìŠ¤íŠ¸ ì‹œ "Higgsfield API credentials not configured" ì—ëŸ¬
- ì´ì „ì— ì˜ ë˜ë˜ ê¸°ëŠ¥ì´ ê°‘ìê¸° ì‘ë™ ì•ˆ í•¨

#### ì›ì¸

- `.env.local` íŒŒì¼ì´ ë®ì–´ì¨ì§€ë©´ì„œ HIGGSFIELD ê´€ë ¨ í‚¤ê°€ ì‚­ì œë¨
- Vercelì—ì„œ HIGGSFIELD_API_KEY, HIGGSFIELD_API_SECRETì´ **Production í™˜ê²½ì—ë§Œ** ì„¤ì •ë¨
- `vercel env pull`ì€ Development í™˜ê²½ ë³€ìˆ˜ë§Œ ê°€ì ¸ì˜´

#### í•´ê²° ë°©ë²•

1. Production í™˜ê²½ ë³€ìˆ˜ ê°€ì ¸ì˜¤ê¸°:
   ```bash
   npx vercel env pull .env.production --environment=production
   ```

2. HIGGSFIELD í‚¤ì™€ FIREBASE_SERVICE_ACCOUNT_KEYë¥¼ `.env.local`ì— ìˆ˜ë™ ì¶”ê°€

#### êµí›ˆ

- `.env.local` ìˆ˜ì • ì‹œ ê¸°ì¡´ ë‚´ìš© ë³´ì¡´ í•„ìˆ˜ (Write ëŒ€ì‹  Edit ì‚¬ìš©)
- Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì‹œ Development í™˜ê²½ë„ ì²´í¬í•  ê²ƒ

---

### ì˜¤ë¥˜ #20: Vercel FFmpeg ë¯¸ì‘ë™ âœ…

**ë°œìƒì¼**: 2026-01-23
**ì™„ë£Œì¼**: 2026-01-23
**íŒŒì¼**: `next.config.ts`, `vercel.json`
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ

#### ë¬¸ì œ ìƒí™©

- Vercel ë°°í¬ í›„ ì˜ìƒ í•©ì„±(merge) ì‹œ 3ê°œ ì˜ìƒì´ ì•„ë‹Œ 1ê°œë§Œ ë°˜í™˜
- ë¡œì»¬ì—ì„œëŠ” ì •ìƒ ì‘ë™

#### ì›ì¸

- Next.js ë¹Œë“œ ì‹œ ffmpeg-static ë°”ì´ë„ˆë¦¬ê°€ ë²ˆë“¤ì—ì„œ ì œì™¸ë¨
- FFmpegë¥¼ ì°¾ì§€ ëª»í•˜ë©´ ì²« ë²ˆì§¸ ì˜ìƒë§Œ ë°˜í™˜í•˜ëŠ” fallback ë¡œì§ ì‹¤í–‰

#### í•´ê²° ë°©ë²•

`next.config.ts`ì— `outputFileTracingIncludes` ì„¤ì • ì¶”ê°€:
```typescript
outputFileTracingIncludes: {
  '/api/ai/merge-videos': ['./node_modules/ffmpeg-static/ffmpeg'],
  '/api/ai/loop-video': ['./node_modules/ffmpeg-static/ffmpeg'],
},
serverExternalPackages: [..., 'ffmpeg-static'],
```

**ì°¸ê³ **: [Vercel Labs - FFmpeg on Vercel](https://github.com/vercel-labs/ffmpeg-on-vercel)

---

### ì˜¤ë¥˜ #19: 413 Payload Too Large âœ…

**ë°œìƒì¼**: 2026-01-23
**ì™„ë£Œì¼**: 2026-01-23
**íŒŒì¼**: `check-video-status/route.ts`, `merge-videos/route.ts`
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ

#### ë¬¸ì œ ìƒí™©

- AI ì˜ìƒ í•©ì„± ì‹œ 3ê°œ ì˜ìƒ í•©ì„± ë‹¨ê³„ì—ì„œ 413 ì—ëŸ¬ ë°œìƒ
- ê° ì˜ìƒì´ ~30MB, 3ê°œ = 90MB+ ìš”ì²­ í˜ì´ë¡œë“œ

#### ì›ì¸

- `check-video-status` APIê°€ ìƒì„±ëœ ì˜ìƒì„ Base64ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜
- Base64 ì¸ì½”ë”©ìœ¼ë¡œ ~33% í¬ê¸° ì¦ê°€ â†’ 90MB+ ìš”ì²­ ë°œìƒ

#### í•´ê²° ë°©ë²•

ì˜ìƒì„ Firebase Storageì— ì—…ë¡œë“œ í›„ URLë§Œ ë°˜í™˜:
```typescript
const bucket = getStorage().bucket();
await file.save(buffer, { metadata: { contentType: 'video/mp4' } });
await file.makePublic();
finalVideoUrl = `https://storage.googleapis.com/${bucket.name}/${uploadPath}`;
```

---

### ì˜¤ë¥˜ #18: Firebase Storage CORS ì—ëŸ¬ âœ…

**ë°œìƒì¼**: 2026-01-23
**ì™„ë£Œì¼**: 2026-01-23
**íŒŒì¼**: `cors.json`
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ

#### ë¬¸ì œ ìƒí™©

- ë¸Œë¼ìš°ì €ì—ì„œ Firebase Storage ì˜ìƒì— ì ‘ê·¼ ë¶ˆê°€
- `Access-Control-Allow-Origin` í—¤ë” ëˆ„ë½ ì—ëŸ¬

#### í•´ê²° ë°©ë²•

```json
[{
  "origin": ["https://www.flower-signage.com", "http://localhost:3000"],
  "method": ["GET", "HEAD", "OPTIONS"],
  "maxAgeSeconds": 3600,
  "responseHeader": ["Content-Type", "Content-Length", "Content-Range", "Accept-Ranges"]
}]
```

ì ìš©: `gsutil cors set cors.json gs://flower-63624.firebasestorage.app`

---

## ì´ì „ í•´ê²°ëœ ì˜¤ë¥˜ (2026-01-11)

### ì˜¤ë¥˜ #15: Remotion "Target Closed" ì—ëŸ¬ (ë©”ëª¨ë¦¬ í¬ë˜ì‹œ) âœ…

**ë°œìƒì¼**: 2026-01-11
**ì™„ë£Œì¼**: 2026-01-11
**íŒŒì¼**: `render-text-overlay/route.ts`, `temp-video/[id]/route.ts`
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ (í…ŒìŠ¤íŠ¸ ì„±ê³µ)

#### ì˜¤ë¥˜ ë©”ì‹œì§€
```
Protocol error (Page.addScriptToEvaluateOnNewDocument): Target closed.
https://www.remotion.dev/docs/target-closed
```

**í„°ë¯¸ë„ ë¡œê·¸**:
```
Starting Remotion text overlay rendering with 6 texts
Using Base64 video data URL directly for Remotion
Bundling Remotion composition...
Bundle created: C:\Users\jayit\AppData\Local\Temp\remotion-webpack-bundle-4Nk9OO
Remotion Rendering Error: [Error [ProtocolError]: Protocol error...
POST /api/ai/render-text-overlay 500 in 16595ms
```

#### ì›ì¸

**Puppeteer/Chrome ë¸Œë¼ìš°ì € ë©”ëª¨ë¦¬ í¬ë˜ì‹œ**:

1. **Base64 ë¹„ë””ì˜¤ í¬ê¸° ë¬¸ì œ**
   - 30ì´ˆ 1080x1080 ì˜ìƒ = 5-15MB
   - Base64 ì¸ì½”ë”© â†’ 33% ì¦ê°€ = 7-20MB
   - Chromeì´ ê±°ëŒ€í•œ Data URL ì²˜ë¦¬ ì‹¤íŒ¨

2. **Remotion Video ì»´í¬ë„ŒíŠ¸ ì œì•½**
   - `<Video src="data:video/mp4;base64,..." />`
   - Chromeì´ Base64ë¥¼ ë©”ëª¨ë¦¬ì— ì „ì²´ ë¡œë“œ ì‹œë„
   - ë©”ëª¨ë¦¬ ë¶€ì¡± â†’ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (16ì´ˆ í›„ í¬ë˜ì‹œ)

3. **Vercel ì„œë²„ë¦¬ìŠ¤ ë©”ëª¨ë¦¬ ì œí•œ**
   - Chrome + Remotion + ëŒ€ìš©ëŸ‰ Base64 = ë©”ëª¨ë¦¬ ì´ˆê³¼

#### í•´ê²° ë°©ë²•

**ì„ì‹œ HTTP ì„œë²„ë¡œ íŒŒì¼ ì œê³µ**:

**ì „ëµ**:
1. Base64 â†’ ì„ì‹œ íŒŒì¼ ì €ì¥ (`os.tmpdir()`)
2. Next.js API routeë¡œ íŒŒì¼ ìŠ¤íŠ¸ë¦¬ë° ì œê³µ
3. Remotionì— HTTP URL ì „ë‹¬: `http://localhost:3000/api/temp-video/remotion_input_12345.mp4`
4. Chromeì´ HTTP ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ë¹„ë””ì˜¤ ë¡œë“œ (ë©”ëª¨ë¦¬ íš¨ìœ¨ì )

**êµ¬í˜„ ì™„ë£Œ**:
1. âœ… `src/app/api/temp-video/[id]/route.ts` (ì‹ ê·œ ìƒì„±)
   - GET ìš”ì²­ìœ¼ë¡œ ì„ì‹œ íŒŒì¼ ìŠ¤íŠ¸ë¦¬ë°
   - `Content-Type: video/mp4` í—¤ë” ì„¤ì •
   - ë³´ì•ˆ: `remotion_input_*.mp4` íŒ¨í„´ë§Œ í—ˆìš©

2. âœ… `src/app/api/ai/render-text-overlay/route.ts` (ìˆ˜ì •)
   - Base64 â†’ ì„ì‹œ íŒŒì¼ ì €ì¥
   - HTTP URL ìƒì„±í•˜ì—¬ Remotionì— ì „ë‹¬
   - ë Œë”ë§ ì™„ë£Œ í›„ ì„ì‹œ íŒŒì¼ ì‚­ì œ

**ê²°ê³¼**:
- âœ… Chrome ë©”ëª¨ë¦¬ ë¶€ë‹´ ê°ì†Œ (ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹)
- âœ… "Target closed" ì—ëŸ¬ ì™„ì „ í•´ê²°
- âœ… ì•ˆì •ì ì¸ 30ì´ˆ ì˜ìƒ ë Œë”ë§ ì„±ê³µ (15ë¶„ ì†Œìš” â†’ ëŒ€í­ ë‹¨ì¶•)

**í…ŒìŠ¤íŠ¸ ì™„ë£Œ**: ì •ìƒ ì‘ë™ í™•ì¸ âœ…

#### ìƒì„¸ ì •ë³´

ìì„¸í•œ ìˆ˜ì • ê³¼ì •ì€ [archive/error-fix-remotion-target-closed.md](./archive/error-fix-remotion-target-closed.md) ì°¸ê³ 

---

### ì˜¤ë¥˜ #16: Remotion ë Œë”ë§ ì†ë„ & ResultStep ë©”ëª¨ë¦¬ í¬ë˜ì‹œ âœ…

**ë°œìƒì¼**: 2026-01-11
**ì™„ë£Œì¼**: 2026-01-11
**íŒŒì¼**: `render-text-overlay/route.ts`, `ResultStep.tsx`
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ

#### ë¬¸ì œì 

1. **ë Œë”ë§ ì†ë„**: 15ë¶„ ì†Œìš” (Vercel 5ë¶„ ì œí•œ ì´ˆê³¼)
2. **ë¸Œë¼ìš°ì € í¬ë˜ì‹œ**: "í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ ì ìš©í•˜ê¸°" ë²„íŠ¼ í´ë¦­ ì‹œ "í˜ì´ì§€ë¥¼ í‘œì‹œí•  ìˆ˜ ì—†ìŒ"

#### í•´ê²° ë°©ë²•

**ì„±ëŠ¥ ìµœì í™”**:
1. âœ… ë²ˆë“¤ ìºì‹± êµ¬í˜„ (ë‘ ë²ˆì§¸ ìš”ì²­ë¶€í„° 3-5ë¶„ ì ˆì•½)
2. âœ… Concurrency ìµœì í™” (4ë¡œ ê³ ì •)
3. âœ… ë¹„íŠ¸ë ˆì´íŠ¸ ê°ì†Œ (3M)
4. âœ… FPS ê°ì†Œ (24)

**ë©”ëª¨ë¦¬ í¬ë˜ì‹œ ìˆ˜ì •**:
- Base64 â†’ Blob ë³€í™˜
- JSON â†’ FormData ì „ì†¡
- multipart/form-data ì§€ì› ì¶”ê°€

**ê²°ê³¼**:
- âœ… ë Œë”ë§ ì‹œê°„ ëŒ€í­ ë‹¨ì¶•
- âœ… ë¸Œë¼ìš°ì € í¬ë˜ì‹œ ì—†ìŒ
- âœ… í˜ì´ì§€ ì•ˆì •ì„± í™•ë³´

#### ìƒì„¸ ì •ë³´

ìì„¸í•œ ìµœì í™” ê³¼ì •ì€ [archive/remotion-performance-optimization.md](./archive/remotion-performance-optimization.md) ì°¸ê³ 

---

## ìµœê·¼ í•´ê²°ëœ ì˜¤ë¥˜ (2026-01-12)

### ì˜¤ë¥˜ #17: ì˜ìƒ ë²„ë²…ì„ ë¬¸ì œ (VFR â†’ CFR ë³€í™˜) âœ…

**ë°œìƒì¼**: 2026-01-12
**ì™„ë£Œì¼**: 2026-01-12
**íŒŒì¼**: `loop-video/route.ts`
**ìƒíƒœ**: âœ… í•´ê²° ì™„ë£Œ

#### ë¬¸ì œ ìƒí™©

**ì¦ìƒ**:
- AI ìƒì„± í™€ë¡œê·¸ë¨ ì˜ìƒì—ì„œ ì§€ì†ì ì¸ ë²„ë²…ì„(lag/stutter) ë°œìƒ
- ë£¨í”„ ì§€ì ë¿ë§Œ ì•„ë‹ˆë¼ ì „ì²´ ì˜ìƒì—ì„œ ë¯¸ì„¸í•œ ëŠê¹€ í˜„ìƒ
- 30fpsë¡œ ì„¤ì •í–ˆìŒì—ë„ í”„ë ˆì„ ë“œë/ìŠ¤í‚µ ë°œìƒ

**ê·¼ë³¸ ì›ì¸**: "Frankenstein Video" ë¬¸ì œ
1. AI ìƒì„± ë¹„ë””ì˜¤ê°€ **Variable Frame Rate (VFR)** ì‚¬ìš©
2. `loop-video/route.ts`ì—ì„œ `-c copy` ì‚¬ìš©ìœ¼ë¡œ VFR ê·¸ëŒ€ë¡œ ë³´ì¡´
3. concat ì‹œ VFR + CFR ë¹„ë””ì˜¤ í˜¼í•©ìœ¼ë¡œ íƒ€ì„ë² ì´ìŠ¤ ì¶©ëŒ
4. Remotionì´ CFR 30fpsë¥¼ ê¸°ëŒ€í•˜ì§€ë§Œ VFR ì†ŒìŠ¤ë¡œ ì¸í•œ ë Œë”ë§ ì¶©ëŒ

#### í•´ê²° ë°©ë²•: "Sanitize First" ì „ëµ

**í•µì‹¬**: AI ì›ë³¸ ë¹„ë””ì˜¤ë¥¼ ë¨¼ì € CFR 30fpsë¡œ í‘œì¤€í™”í•œ í›„ ëª¨ë“  ì²˜ë¦¬ ì§„í–‰

**ìˆ˜ì • ë‚´ìš©**:
1. **Step 0 (ì‹ ê·œ)**: ì›ë³¸ì„ CFR 30fps + GOP 30ìœ¼ë¡œ í‘œì¤€í™”
2. **Step 1 (ìˆ˜ì •)**: í‘œì¤€í™”ëœ ì†ŒìŠ¤ì—ì„œ ì—­ë°©í–¥ ìƒì„± (`trim` ì¶”ê°€ë¡œ ì¤‘ë³µ ë°©ì§€)
3. **Step 2 (ìˆ˜ì •)**: ë™ì¼ ìŠ¤í™ concat â†’ `-c copy` ì‚¬ìš© (ì¬ì¸ì½”ë”© ë¶ˆí•„ìš”)
4. **Step 3 (ìˆ˜ì •)**: ping-pong ë°˜ë³µ â†’ `-c copy` ì‚¬ìš© (ì¬ì¸ì½”ë”© ë¶ˆí•„ìš”)

**ì£¼ìš” íŒŒë¼ë¯¸í„°**:
- `-r 30`: CFR 30fps ê°•ì œ
- `-g 30`: GOP í¬ê¸° 30 (1ì´ˆë§ˆë‹¤ keyframe, Remotion seeking ìµœì í™”)
- `-sc_threshold 0`: Scene change detection ë¹„í™œì„±í™” (ì¼ê´€ëœ GOP ë³´ì¥)
- `-crf 18`: ê±°ì˜ ë¬´ì†ì‹¤ í’ˆì§ˆ

#### ê°œì„  íš¨ê³¼

| í•­ëª© | Before | After | íš¨ê³¼ |
|------|--------|-------|------|
| VFR ì²˜ë¦¬ | concat í›„ ì¬ì¸ì½”ë”© | **ë¨¼ì € CFR ë³€í™˜** | âœ… ê·¼ë³¸ í•´ê²° |
| íƒ€ì„ë² ì´ìŠ¤ | VFR+CFR í˜¼í•© | **ì™„ì „ í†µì¼** | âœ… concat ì•ˆì •ì„± |
| GOP ìµœì í™” | ì—†ìŒ | **-g 30 ì¶”ê°€** | âœ… Remotion seeking |
| ì²˜ë¦¬ ì†ë„ | ~45ì´ˆ (3ë²ˆ ì¬ì¸ì½”ë”©) | **~30ì´ˆ** (1ë²ˆë§Œ) | âœ… 15ì´ˆ ë‹¨ì¶• |
| í’ˆì§ˆ | CRF 18 (2ë²ˆ ì†ì‹¤) | **CRF 18 + copy** | âœ… ì†ì‹¤ ìµœì†Œí™” |

**ê²°ê³¼**:
- âœ… ì™„ë²½í•œ CFR 30fps ë¹„ë””ì˜¤
- âœ… ì˜ìƒ ë²„ë²…ì„ ì™„ì „ ì œê±°
- âœ… Remotion ë Œë”ë§ ìµœì í™”
- âœ… ì²˜ë¦¬ ì†ë„ 15ì´ˆ ë‹¨ì¶•

#### ìƒì„¸ ì •ë³´

ìì„¸í•œ ë¶„ì„ ë° ê¸°ìˆ  ì„¤ëª…ì€ [archive/error-fix-video-stuttering-vfr.md](./archive/error-fix-video-stuttering-vfr.md) ì°¸ê³ 

---

## ì°¸ê³  ë§í¬

### AI ì´ë¯¸ì§€ ìƒì„±
- [Google Gemini ë¬¸ì„œ](https://ai.google.dev/gemini-api/docs)

### AI ì˜ìƒ ìƒì„±
- [Higgsfield ë¬¸ì„œ](https://docs.higgsfield.ai/llms.txt)

### ì˜ìƒ ì²˜ë¦¬
- [FastPix: Video Loop](https://www.fastpix.io/blog/how-to-loop-video-playback-in-html)
- [W3Schools: Video Loop](https://www.w3schools.com/tags/att_video_loop.asp)

---

## ì•„ì¹´ì´ë¸Œ ê¸°ë¡

- [2026ë…„ 1ì›” ì•„ì¹´ì´ë¸Œ](./archive/ì˜¤ë¥˜í•´ê²°-2026-01-archived.md) - ì˜¤ë¥˜ #1~#13 (13ê±´)
- [Remotion Target Closed ì—ëŸ¬](./archive/error-fix-remotion-target-closed.md) - ì˜¤ë¥˜ #15 âœ…
- [Remotion ì„±ëŠ¥ ìµœì í™”](./archive/remotion-performance-optimization.md) - ì˜¤ë¥˜ #16 âœ…
- [ì˜ìƒ ë²„ë²…ì„ ë¬¸ì œ (VFR â†’ CFR)](./archive/error-fix-video-stuttering-vfr.md) - ì˜¤ë¥˜ #17 âœ…
- [413 Payload Too Large í•´ê²°](./archive/CORS-413-ERROR-FIX.md) - ì˜¤ë¥˜ #18, #19 âœ…
- [Vercel FFmpeg ì‘ë™ ë¬¸ì œ](./archive/FFMPEG-MERGE-BUG-ANALYSIS.md) - ì˜¤ë¥˜ #20 âœ…

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-01-23
